PREFIX='/usr'
DESTDIR=''

EXECUTABLE_NAME=retrosmart-x11-cursors

package: $(EXECUTABLE_NAME)-black $(EXECUTABLE_NAME)-white $(EXECUTABLE_NAME)-black-color $(EXECUTABLE_NAME)-white-color

retrosmart-x11-cursors-black: black cursors
	mkdir -p $@/cursors/
	mv $</*.cursor $@/cursors/
	cd $@/cursors/; ../../makelinks.sh
	cp $</index.theme $@/

retrosmart-x11-cursors-white: white cursors
	mkdir -p $@/cursors/
	mv $</*.cursor $@/cursors/
	cd $@/cursors/; ../../makelinks.sh
	cp $</index.theme $@/

retrosmart-x11-cursors-black-color: black-color cursors
	mkdir -p $@/cursors/
	mv $</*.cursor $@/cursors/
	cd $@/cursors/; ../../makelinks.sh
	cp $</index.theme $@/

retrosmart-x11-cursors-white-color: white-color cursors
	mkdir -p $@/cursors/
	mv $</*.cursor $@/cursors/
	cd $@/cursors/; ../../makelinks.sh
	cp $</index.theme $@/

clean:
	rm -f $(CURSORS) $(PNGS) $(CONFIGS)
	rm -rf $(EXECUTABLE_NAME)-*

purge: clean
	rm -f Makefile preview-*.png preview.gif

install:
	install -d -m 755 $(DESTDIR)/$(PREFIX)/share/icons
	chmod -R u+rwX,go+rX $(EXECUTABLE_NAME)-*/
	cp -r $(EXECUTABLE_NAME)-*/ $(DESTDIR)/$(PREFIX)/share/icons/

uninstall:
	rm -rf $(DESTDIR)/$(PREFIX)/share/icons/$(EXECUTABLE_NAME)-*/

user_install:
	mkdir -p ~/.icons/
	cp -r $(EXECUTABLE_NAME)-*/ ~/.icons/

user_uninstall:
	rm -rf ~/.icons/$(EXECUTABLE_NAME)-*/

preview-black.png: black
	montage -geometry +8+8 $(shell find $^/*/24/ -type f -name "*.xpm" | grep -v '[2-8].xpm' | sort) $@

preview-white.png: white
	montage -geometry +8+8 $(shell find $^/*/24/ -type f -name "*.xpm" | grep -v '[2-8].xpm' | sort) $@

preview-black-color.png: black-color
	montage -geometry +8+8 $(shell find $^/*/24/ -type f -name "*.xpm" | grep -v '[2-8].xpm' | sort) $@

preview-white-color.png: white-color
	montage -geometry +8+8 $(shell find $^/*/24/ -type f -name "*.xpm" | grep -v '[2-8].xpm' | sort) $@

preview.gif: preview-black.png preview-white.png preview-black-color.png preview-white-color.png
	convert -loop 0 -delay 500 $^ $@
